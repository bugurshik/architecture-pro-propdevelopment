# Отчёт по результатам анализа Kubernetes Audit Log
## Подозрительные события

1. Доступ к секретам:
Кто: serviceaccount:secure-ops:monitoring
Где: kube-system (через запрос к секрету, связанному с default-token)
Почему подозрительно: Попытка получения доступа к секретам, которые содержат чувствительную информацию, может быть признаком действия злоумышленника.

2. Привилегированные поды:
Кто: minikube-user
Комментарий: Создание пода privileged-pod с securityContext.privileged=true — опасное действие, так как предоставляет контейнеру почти все привилегии хостовой системы, такие поды не должны создаваться без явной необходимости.

3. Использование kubectl exec в чужом поде:
Кто: system:apiserver
Что делал: Выполнение команды cat /etc/resolv.conf внутри одного из подов CoreDNS в пространстве имен kube-system
Почему подозрительно: Использование kubectl exec в системных подах, особенно в kube-system, может свидетельствовать о попытке исследования среды или выполнении вредоносной активности.

4. Создание RoleBinding с правами cluster-admin:
Кто: system:serviceaccount:kube-system:storage-provisioner
К чему привело: Назначение роли cluster-admin ServiceAccount monitoring в namespace secure-ops
Опасность: Это прямая эскалация привилегий, предоставляющая полный контроль над всем кластером. Такое поведение характерно для атакующих, добравшихся до внутренней части кластера.

5. Удаление audit-policy.yaml:
Кто: system:apiserver. Пользователь, действующий от имени --as=admin
Возможные последствия: Удаление политики аудита может быть попыткой скрыть следы злонамеренной активности.

## Вывод
Выявленные события указывают на наличие явных признаков атаки в кластере Kubernetes:

Назначение привилегий через ClusterRole cluster-admin непривилегированному ServiceAccount.
Перемещение,сбор и чтение секретов и выполнения команд в системных подах.
Попытка затруднить расследование удалением конфигурации аудита
Нарушение принципов безопасности — использование привилегированных контейнеров без явной необходимости.
Рекомендуется:

Пересмотреть RBAC-политики, особенно выдачу прав cluster-admin.
Включить и настроить подробное логирование аудита.
Мониторить и ограничивать использование kubectl exec.
Регулярно проверять список ServiceAccounts и их привязки к ролям.
Обеспечить защиту системных пространств имён (kube-system) от внешнего доступа.
